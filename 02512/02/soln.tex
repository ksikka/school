\documentclass[11pt,letterpaper]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{fancyhdr}
\usepackage{verbatim}
\usepackage{graphicx}


\oddsidemargin0cm
\topmargin-2cm
\textwidth16.5cm
\textheight23.5cm

\newcommand{\question}[1] {\vspace{.25in} \hrule\vspace{0.5em}
\noindent{\bf #1} \vspace{0.5em}
\hrule \vspace{.10in}}
\renewcommand{\part}[1] {\vspace{.10in} {\bf (#1)}}

\newcommand{\myname}{Karan Sikka}
\newcommand{\myandrew}{ksikka@cmu.edu}
\newcommand{\myhwnum}{02}

\setlength{\parindent}{0pt}
\setlength{\parskip}{5pt plus 1pt}

\pagestyle{fancyplain}
\lhead{\fancyplain{}{\textbf{PS\myhwnum}}}
\rhead{\fancyplain{}{\myname\\ \myandrew}}
\chead{\fancyplain{}{02-512}}

\begin{document}

\medskip

\thispagestyle{plain}
\begin{center}                  % Center the following lines
{\Large 02-512 Assignment \myhwnum} \\
\myname \\
\myandrew \\
\today
\end{center}

\question{1}

\part{a}

For one combination of substitutions made, define the following variables:

Let $\vec{x}$ be an n-dimensional vector of 1s and 0s where $x_i$ is 1
if the $i^{th}$ substitution was made, and 0 if not.

Let $\vec{k}$ be an n-dimensional vector of weights, where $k_i$ is the amount
that making the $i^{th}$ substitution contributes to the expression level.

Let $c$ be the baseline expression level.

Let $y$ be the expression level.

Then:

$$\vec{k} \cdot \vec{x} + c = y$$

If we have $n+1$ such equations, one for each combination, we can represent the linear
system in the following matrix: ($x_i$ will now be $x_{j,i}$ where $j$ is the ordinal number of the combination/equation, and apply a similar transformation to the indexes of $k$ and $y$)

$
 \begin{bmatrix}
  x_{1,1} & x_{1,2} & \cdots & x_{1,n} & 1\\
  x_{2,1} & x_{2,2} & \cdots & x_{2,n} & 1\\
  \vdots  & \vdots  & \ddots & \vdots  \\
  x_{n+1,1} & x_{n+1,2} & \cdots & x_{n+1,n} & 1
 \end{bmatrix}
 \begin{bmatrix}
  k_{1} \\
  k_{2} \\
  \vdots  \\
  k_{n} \\
  c
 \end{bmatrix}
 =
 \begin{bmatrix}
  y_{1} \\
  y_{2} \\
  \vdots  \\
  y_{n+1}
 \end{bmatrix}
$

We know the eqns are independent since the combinations of substitutions are distinct, and may not be scalar multiples of one another because all values are zero or one.

The problem is in the canonical $A\vec{x} = \vec{b}$ form (but we'll call it  $X \vec{k} = \vec{y})$.
The A matrix is full-rank (number of rows equals number of columns), and you'll find exact solutions for $\vec{k}$ using Gaussian Elimination.

\part{b}
Now we have $n^2$ equations rather than $n+1$ and the number of rows is greater than the number of columns.

Therefore the system is overdetermined.
Given our overdetermined system $X \vec{k} = \vec{y}$, we find $\vec{k}$ which minimizes the sum of least-squares by solving the linear system $(X^T X)\vec{k} = (X^T \vec{y})$

\part{c}
We add an entry for each pair of substitions ($n \choose 2$ pairs) to our bit vector $x$ and correspondingly our weight vector $k$ for each experimental test.
The bit vector $x$ had $n+1$ entries before, now we add $n \choose 2 = \frac{1}{2}(n^2 - n)$ entries to result in a total of $\frac{1}{2}(n^2+n+2)$ entries.

The number of entries is larger than $n^2$ when $n \geq 2$ (determined using Wolfram Mathematica), so the system is underdetermined.
There are many valid solutions, but one way to get one solution would be to find the pseudoinverse of the matrix formed by the linear systems (done in a manner similar to part A) using Singular Value Decomposition.
Then mulitply the pseudoinverse by the $\vec{y}$ to obtain a solution for $\vec{k}$ that has the most number of zeros in it.

\question{2}
\part{a}
\begin{alignat*}{2}
  &\quad & F(x) &= \frac{d}{dx} E(x)\\ 
  &&&= \frac{d}{dx} E_1(x) + \frac{d}{dx} E_2(x) \\  
  &&&= \frac{d}{dx} \frac{1}{4} x^{4} + \frac{d}{dx} x^2 \\  
  &&&= x^{3} + 2x
\end{alignat*}

\part{b}
\begin{alignat*}{2}
 & F(x)  = & x^{3} + 2x     & = 5\\
 &\implies & x^{3} + 2x - 5 & = 0
\end{alignat*}

Now we need to find the values of x for which the equation $x^{3} + 2x - 5 = 0$. This is a zero-finding problem.

\part{c}
Bisection method for $f(x) = x^{3} + 2x - 5$\\

Initialization:\\
$x_{min} = 1$ and $x_{max} = 2$.\\
$f_{min} = x_{min}^{3} + 2x_{min} - 5 = 1 + 2 - 5 = -2$\\
$f_{max} = x_{max}^{3} + 2x_{max} - 5 = 8 + 4 - 5 = 7$\\

First round:\\
$x_{mid} = \frac{1+2}{2} = 1.5$\\
$f_{mid} = f(x_{mid}) = 1.375 $\\
It's greater than zero, so:\\
$x_{max} = 1.5$

Second round:\\
$x_{mid} = \frac{1+1.5}{2} = 1.25$\\
$f_{mid} = f(x_{mid}) = -0.546875 $\\
It's less than zero, so:\\
$x_{min} = 1.25$

Third round:\\
$x_{mid} = \frac{1.25+1.5}{2} = 1.375$\\
$f_{mid} = f(x_{mid}) = 0.34961... $\\
It's greater than zero, so:\\
$x_{max} = 1.375$

Return $x = \frac{x_{min} + x_{max}}{2} = \frac{1.25 + 1.375}{2} = 1.3125$\\
The backward error is $x_{max} - x_{min} = 1.375 - 1.25 = 1.125$\\
The forward error is $f(x) = 0.34961...$


\part{d}
Secant method for $f(x) = x^{3} + 2x - 5$\\

Initialization:\\
$x_{min} = 1$ and $x_{max} = 2$.\\
$f_{min} = x_{min}^{3} + 2x_{min} - 5 = 1 + 2 - 5 = -2$\\
$f_{max} = x_{max}^{3} + 2x_{max} - 5 = 8 + 4 - 5 = 7$\\

\newcommand{\xmid}[4]{{#1} - \frac{{#2} - {#1}}{{#4} - {#3}}({#3})}

First round:\\
$x_{mid} = \xmid{x_{min}}{x_{max}}{f_{min}}{f_{max}} = \xmid{1}{2}{{-2}}{7} = 1.222222...$\\
$f_{mid} = f(x_{mid}) = -0.729767 $\\
It's less than zero, so:\\
$x_{min} = 1.222222$\\
$f_{min} = -0.729767$

Second round:\\
$x_{mid} = \xmid{1.222222}{2}{{-0.729767}}{7} = 1.295652...$\\
$f_{mid} = f(x_{mid}) = -0.233665 $\\
It's less than zero, so:\\
$x_{min} = 1.295652 $\\
$f_{min} = -0.233665 $

Third round:\\
$x_{mid}  = \xmid{1.295652}{2}{{-0.233665}}{7} = 1.318404...$\\
$f_{mid} = f(x_{mid}) = -0.071553... $\\
It's less than zero, so:\\
$x_{min} = 1.318404$\\
$f_{min} = -0.071553$

Return $x = \frac{x_{min} + x_{max}}{2} = \frac{1.25 + 1.375}{2} = 1.3125$\\
$x = \xmid{1.318404}{2}{{-0.071553}}{7} = 1.325301...$\\
The backward error is $x_{max} - x_{min} = 2 - 1.25 = 1.325301 $\\
The forward error is $f(x) = -0.021608$

\part{e}
Newton-Raphson method for $f(x) = x^{3} + 2x - 5$\\
For this $f(x)$ we get $f'(x) = 3x^{2} + 2$\\

Initialization:\\
$x_0 = 2$

\newcommand{\newtx}[1]{#1 - \frac{f(#1)}{f'(#1)}}
\newcommand{\newtxx}[3]{#1 - \frac{#2}{#3}}
First round:\\
$x = \newtx{{x_0}} = \newtx{2} = \newtxx{2}{7}{14} = $




\end{document}
